# 实施计划 - 影梭第二阶段：自然语言智能控制

## 概述

本实施计划将影梭第二阶段的自然语言智能控制功能分解为可执行的编码任务。实施基于 React Native + TypeScript 技术栈，使用 fast-check 进行属性测试。

## 任务列表

- [x] 1. 设置项目基础和依赖
  - 安装必要的 npm 包（fast-check, expo-speech, react-native-voice, mmkv, expo-secure-store）
  - 配置 TypeScript 类型定义
  - 创建目录结构（services/, stores/, components/, utils/）
  - _需求: 所有需求的基础_

- [ ] 2. 实现隐私过滤模块
  - [x] 2.1 创建 PrivacyFilter 类和接口
    - 实现 `sanitize()` 方法：检测并替换文件路径、IP地址、密码
    - 实现 `restore()` 方法：根据映射关系还原原始值
    - 实现 `detectSensitiveInfo()` 方法：识别敏感信息类型
    - 使用正则表达式匹配敏感模式
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_
  
  - [ ]* 2.2 编写隐私过滤属性测试
    - **属性 1: 隐私过滤往返一致性**
    - 使用 fast-check 生成随机文本
    - 验证 sanitize → restore 往返一致性
    - **验证需求: 3.1, 3.2, 3.3, 3.4**
  
  - [ ]* 2.3 编写隐私过滤单元测试
    - 测试文件路径脱敏
    - 测试 IP 地址脱敏
    - 测试密码脱敏
    - 测试空字符串和无敏感信息的情况
    - _需求: 3.1, 3.2, 3.3_

- [ ] 3. 实现安全检查器模块
  - [x] 3.1 创建 SecurityChecker 类和接口
    - 实现 `checkCommand()` 方法：检测危险命令模式
    - 实现 `getDangerousPatterns()` 方法：返回危险模式列表
    - 实现 `addDangerousPattern()` 和 `removeDangerousPattern()` 方法
    - 预定义危险命令模式（rm -rf, dd, mkfs, fdisk, format, sudo）
    - _需求: 4.1, 4.2, 4.6, 4.7_
  
  - [ ]* 3.2 编写安全检查器属性测试
    - **属性 2: 危险命令检测完整性**
    - 使用 fast-check 生成随机命令和危险模式
    - 验证所有匹配模式的命令都被标记为危险
    - **验证需求: 4.1, 4.2, 4.6**
  
  - [ ]* 3.3 编写安全检查器单元测试
    - 测试 rm -rf 检测
    - 测试 dd/mkfs/fdisk 检测
    - 测试 sudo 权限警告
    - 测试安全命令（ls, pwd）
    - _需求: 4.1, 4.2, 4.7_


- [ ] 4. 实现命令历史存储
  - [x] 4.1 创建 CommandHistoryStore 类和接口
    - 使用 MMKV 实现本地存储
    - 实现 `addEntry()` 方法：添加历史记录
    - 实现 `getHistory()` 方法：查询历史（支持筛选）
    - 实现 `deleteEntry()` 和 `clearHistory()` 方法
    - 实现 `searchHistory()` 方法：关键词搜索
    - 实现容量限制逻辑（最多1000条，自动删除最旧）
    - _需求: 6.1, 6.2, 6.5, 6.6, 6.7_
  
  - [ ]* 4.2 编写命令历史属性测试
    - **属性 3: 命令历史容量限制**
    - 生成超过1000条的历史记录
    - 验证总数不超过限制
    - **验证需求: 6.6, 6.7**
  
  - [ ]* 4.3 编写命令历史属性测试 - 时间排序
    - **属性 7: 历史记录时间排序**
    - 生成随机时间戳的历史记录
    - 验证返回结果按时间倒序排列
    - **验证需求: 6.2**
  
  - [ ]* 4.4 编写命令历史属性测试 - 筛选正确性
    - **属性 15: 历史记录筛选正确性**
    - 生成随机筛选条件
    - 验证返回结果满足所有筛选条件
    - **验证需求: 6.5**
  
  - [ ]* 4.5 编写命令历史单元测试
    - 测试添加单条记录
    - 测试查询空历史
    - 测试删除记录
    - 测试搜索功能
    - _需求: 6.1, 6.3, 6.4_

- [ ] 5. 实现命令收藏存储
  - [x] 5.1 创建 CommandFavoriteStore 类和接口
    - 使用 MMKV 实现本地存储
    - 实现 `addFavorite()` 方法：添加收藏（检查唯一性）
    - 实现 `getFavorites()` 方法：获取所有收藏
    - 实现 `updateFavorite()` 和 `deleteFavorite()` 方法
    - 实现 `searchFavorites()` 方法：关键词搜索
    - _需求: 7.1, 7.2, 7.3, 7.5, 7.6, 7.7_
  
  - [ ]* 5.2 编写命令收藏属性测试 - 唯一性
    - **属性 8: 收藏命令唯一性**
    - 尝试添加重复的收藏
    - 验证系统拒绝或更新现有收藏
    - **验证需求: 7.2**
  
  - [ ]* 5.3 编写命令收藏属性测试 - 搜索匹配
    - **属性 16: 收藏搜索匹配性**
    - 生成随机搜索查询
    - 验证返回结果包含搜索关键词
    - **验证需求: 7.7**
  
  - [ ]* 5.4 编写命令收藏单元测试
    - 测试添加收藏
    - 测试编辑收藏
    - 测试删除收藏
    - 测试搜索功能
    - _需求: 7.2, 7.5, 7.6, 7.7_

- [ ] 6. 实现审计日志存储
  - [x] 6.1 创建 AuditLogStore 类和接口
    - 使用 MMKV 实现本地存储
    - 实现 `addLog()` 方法：记录完整的命令执行信息
    - 实现 `getLogs()` 方法：查询日志（支持筛选）
    - 实现 `exportLogs()` 方法：导出为 JSON/CSV
    - 实现 `cleanupOldLogs()` 方法：清理过期日志（30天）
    - _需求: 11.1, 11.2, 11.3, 11.4, 11.5, 11.6, 11.7_
  
  - [ ]* 6.2 编写审计日志属性测试 - 保留策略
    - **属性 4: 审计日志保留策略**
    - 生成不同时间戳的日志
    - 执行清理操作
    - 验证只保留指定天数内的日志
    - **验证需求: 11.6, 11.7**
  
  - [ ]* 6.3 编写审计日志属性测试 - 完整性
    - **属性 13: 命令执行审计完整性**
    - 验证日志包含所有必需字段
    - **验证需求: 11.1, 11.2**
  
  - [ ]* 6.4 编写审计日志单元测试
    - 测试添加日志
    - 测试筛选日志
    - 测试导出 JSON
    - 测试导出 CSV
    - _需求: 11.1, 11.3, 11.4, 11.5_

- [x] 7. 检查点 - 数据层测试
  - 确保所有数据存储模块的测试通过
  - 验证 MMKV 存储正常工作
  - 如有问题请向用户报告


- [ ] 8. 实现 API 密钥存储
  - [x] 8.1 创建 APIKeyStore 类和接口
    - 使用 Expo SecureStore 实现加密存储
    - 实现 `saveAPIKey()` 方法：加密保存 API 密钥
    - 实现 `getAPIKey()` 方法：解密获取 API 密钥
    - 实现 `deleteAPIKey()` 方法：删除 API 密钥
    - 实现 `getMaskedAPIKey()` 方法：返回掩码后的密钥（sk-...xyz）
    - 实现 `getConfiguredProviders()` 方法：列出已配置的提供商
    - _需求: 10.1, 10.2, 10.3, 10.7_
  
  - [ ]* 8.2 编写 API 密钥属性测试 - 掩码显示
    - **属性 9: API 密钥掩码显示**
    - 生成随机 API 密钥
    - 验证掩码隐藏大部分内容
    - **验证需求: 10.3**
  
  - [ ]* 8.3 编写 API 密钥单元测试
    - 测试保存密钥
    - 测试获取密钥
    - 测试删除密钥
    - 测试多提供商支持
    - _需求: 10.2, 10.5, 10.7_

- [ ] 9. 实现 AI 服务接口
  - [x] 9.1 创建 AIService 抽象接口
    - 定义 `sendRequest()` 方法接口
    - 定义 `validateAPIKey()` 方法接口
    - 定义 `getServiceStatus()` 方法接口
    - _需求: 1.1, 10.4, 10.6_
  
  - [x] 9.2 实现 OpenAIService
    - 实现 OpenAI GPT-4 API 调用
    - 处理超时和错误
    - 实现 API 密钥验证
    - 构造合适的 prompt 用于命令解析
    - _需求: 1.1, 1.6, 10.4_
  
  - [x] 9.3 实现 ClaudeService
    - 实现 Claude 3.5 Sonnet API 调用
    - 处理超时和错误
    - 实现 API 密钥验证
    - 构造合适的 prompt 用于命令解析
    - _需求: 1.1, 1.6, 10.4_
  
  - [ ]* 9.4 编写 AI 服务单元测试
    - 测试 API 调用成功场景
    - 测试超时处理
    - 测试 API 密钥验证
    - 测试错误处理
    - _需求: 1.1, 1.6, 10.4, 10.6_

- [ ] 10. 实现自然语言控制器
  - [x] 10.1 创建 NLController 类
    - 实现 `parseNaturalLanguage()` 方法：协调整个解析流程
    - 集成 PrivacyFilter：发送前脱敏
    - 调用 AIService：获取解析结果
    - 集成 SecurityChecker：检查危险命令
    - 实现 `executeCommand()` 方法：通过 SSH 执行命令
    - 实现 `cancelParsing()` 方法：取消正在进行的请求
    - _需求: 1.1, 1.2, 1.3, 1.4, 1.6, 1.7_
  
  - [ ]* 10.2 编写 NL 控制器属性测试 - 超时处理
    - **属性 17: AI 服务超时处理**
    - 模拟超时场景
    - 验证系统取消请求并显示提示
    - **验证需求: 1.6**
  
  - [ ]* 10.3 编写 NL 控制器属性测试 - 命令确认
    - **属性 18: 命令确认前展示**
    - 验证命令在执行前必须展示给用户
    - **验证需求: 1.2**
  
  - [ ]* 10.4 编写 NL 控制器属性测试 - 危险命令确认
    - **属性 14: 危险命令二次确认**
    - 验证危险命令需要明确确认
    - **验证需求: 4.3, 4.4**
  
  - [ ]* 10.5 编写 NL 控制器单元测试
    - 测试成功解析场景
    - 测试解析失败场景
    - 测试命令执行成功
    - 测试命令执行失败
    - _需求: 1.1, 1.3, 1.4, 1.7_

- [ ] 11. 实现语音输入模块
  - [x] 11.1 创建 VoiceInputModule 类
    - 使用 Expo Speech 或 React Native Voice
    - 实现 `startRecording()` 方法：开始录音
    - 实现 `stopRecording()` 方法：停止录音并识别
    - 实现 `cancelRecording()` 方法：取消录音
    - 实现 `checkPermission()` 和 `requestPermission()` 方法
    - 实现 `getRecordingStatus()` 方法：获取录音状态
    - 支持中英文语音识别
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.6_
  
  - [ ]* 11.2 编写语音输入属性测试 - 结果显示
    - **属性 19: 语音识别结果显示**
    - 验证识别文本显示在输入框
    - **验证需求: 2.3**
  
  - [ ]* 11.3 编写语音输入单元测试
    - 测试开始录音
    - 测试停止录音
    - 测试取消录音
    - 测试权限检查
    - 测试识别失败场景
    - _需求: 2.1, 2.2, 2.4_

- [ ] 12. 检查点 - 核心服务测试
  - 确保所有核心服务模块的测试通过
  - 验证 AI 服务集成正常
  - 验证语音输入功能正常
  - 如有问题请向用户报告


- [ ] 13. 实现命令建议引擎
  - [x] 13.1 创建 SuggestionEngine 类
    - 实现 `getSuggestions()` 方法：基于输入和上下文返回建议
    - 实现建议排序逻辑：最近使用的命令优先
    - 实现上下文相关建议：基于当前目录
    - 实现 `recordCommandUsage()` 方法：记录命令使用
    - 实现建议缓存机制
    - 限制建议数量（最多5条）
    - 确保响应时间在500ms内
    - _需求: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7_
  
  - [ ]* 13.2 编写命令建议属性测试 - 数量限制
    - **属性 5: 命令建议数量限制**
    - 生成随机输入和上下文
    - 验证建议数量不超过5条
    - **验证需求: 5.6**
  
  - [ ]* 13.3 编写命令建议属性测试 - 排序正确性
    - **属性 6: 命令建议排序正确性**
    - 验证最近使用的命令排在前面
    - **验证需求: 5.4**
  
  - [ ]* 13.4 编写命令建议单元测试
    - 测试空输入
    - 测试无匹配建议
    - 测试精确匹配
    - 测试模糊匹配
    - 测试上下文相关建议
    - _需求: 5.1, 5.3, 5.7_

- [ ] 14. 实现离线模式管理
  - [x] 14.1 创建离线模式状态管理
    - 使用 Zustand 管理离线/在线状态
    - 实现网络状态监听
    - 实现自动切换逻辑
    - 实现手动切换功能
    - _需求: 9.1, 9.5, 9.7_
  
  - [x] 14.2 实现离线模式功能降级
    - 离线时禁用自然语言解析
    - 离线时保持历史和收藏可用
    - 离线时允许直接输入命令
    - 显示离线模式提示
    - _需求: 9.2, 9.3, 9.4, 9.6_
  
  - [ ]* 14.3 编写离线模式属性测试
    - **属性 10: 离线模式功能降级**
    - 验证离线时解析功能禁用
    - 验证离线时历史收藏可用
    - **验证需求: 9.2, 9.3**
  
  - [ ]* 14.4 编写离线模式单元测试
    - 测试自动切换到离线
    - 测试手动切换
    - 测试恢复在线
    - 测试离线功能可用性
    - _需求: 9.1, 9.4, 9.5, 9.7_

<!-- - [ ] 15. 实现多语言支持
  - [ ] 15.1 创建国际化配置
    - 使用 i18n 库（如 react-i18next）
    - 创建中文和英文翻译文件
    - 实现语言切换功能
    - 实现语言偏好保存
    - _需求: 13.1, 13.2, 13.5, 13.6_
  
  - [ ] 15.2 实现语言自动检测
    - 检测用户输入的语言（中文/英文）
    - 根据系统语言选择语音识别引擎
    - _需求: 13.3, 13.4_
  
  - [ ]* 15.3 编写多语言属性测试
    - **属性 12: 语言切换一致性**
    - 验证切换语言后所有文本更新
    - **验证需求: 13.2, 13.7**
  
  - [ ]* 15.4 编写多语言单元测试
    - 测试语言切换
    - 测试语言自动检测
    - 测试语言偏好保存
    - _需求: 13.1, 13.3, 13.6_ -->

- [ ] 16. 实现错误处理系统
  - [x] 16.1 创建错误处理器类
    - 实现 NetworkErrorHandler
    - 实现 AuthErrorHandler
    - 实现 ParsingErrorHandler
    - 实现 ExecutionErrorHandler
    - 实现 StorageErrorHandler
    - 实现 PermissionErrorHandler
    - _需求: 14.1, 14.2, 14.3, 14.5, 14.6_
  
  - [x] 16.2 实现错误恢复策略
    - 实现自动重试机制（最多3次）
    - 实现降级服务（切换到离线模式）
    - 实现错误日志记录
    - _需求: 14.7_
  
  - [ ]* 16.3 编写错误处理属性测试
    - **属性 20: 错误信息完整性**
    - 验证错误包含退出码和错误输出
    - **验证需求: 14.2**
  
  - [ ]* 16.4 编写错误处理单元测试
    - 测试各种错误类型的处理
    - 测试自动重试
    - 测试降级服务
    - 测试错误日志记录
    - _需求: 14.1, 14.3, 14.5, 14.6, 14.7_

- [ ] 17. 检查点 - 辅助功能测试
  - 确保所有辅助功能模块的测试通过
  - 验证建议引擎性能
  - 验证离线模式切换
  - 验证多语言支持
  - 验证错误处理
  - 如有问题请向用户报告


- [ ] 18. 实现 AI 对话界面
  - [x] 18.1 创建 AIChatScreen 组件
    - 实现聊天式布局（顶部状态、中部对话、底部输入）
    - 实现消息气泡组件（用户消息、AI消息）
    - 实现输入框和发送按钮
    - 实现语音输入按钮（按住录音）
    - _需求: 8.1, 8.2_
  
  - [x] 18.2 实现对话状态管理
    - 使用 Zustand 管理对话历史
    - 实现消息追加逻辑
    - 实现清除对话功能
    - 保持上下文连续对话
    - _需求: 8.6, 8.7_
  
  - [x] 18.3 实现 AI 响应展示
    - 显示"思考中"动画
    - 显示 AI 返回的命令
    - 显示确认和取消按钮
    - 显示命令执行结果
    - 显示危险命令警告（红色）
    - _需求: 8.3, 8.4, 8.5, 4.1, 4.2_
  
  - [ ]* 18.4 编写 AI 对话界面属性测试
    - **属性 11: 对话历史上下文保持**
    - 验证新消息追加到对话列表
    - 验证时间顺序正确
    - **验证需求: 8.6**
  
  - [ ]* 18.5 编写 AI 对话界面单元测试
    - 测试消息显示
    - 测试发送消息
    - 测试清除对话
    - 测试语音输入触发
    - _需求: 8.2, 8.5, 8.7_

- [ ] 19. 实现命令历史界面
  - [x] 19.1 创建 CommandHistoryScreen 组件
    - 实现历史记录列表
    - 实现时间倒序显示
    - 实现点击查看详情
    - 实现长按显示操作菜单（重新执行、收藏、删除）
    - _需求: 6.2, 6.3, 6.4_
  
  - [x] 19.2 实现历史筛选功能
    - 实现设备筛选
    - 实现时间范围筛选
    - 实现危险命令筛选
    - 实现关键词搜索
    - _需求: 6.5_
  
  - [ ]* 19.3 编写命令历史界面单元测试
    - 测试列表显示
    - 测试筛选功能
    - 测试搜索功能
    - 测试操作菜单
    - _需求: 6.2, 6.3, 6.4, 6.5_

- [ ] 20. 实现命令收藏界面
  - [ ] 20.1 创建 CommandFavoritesScreen 组件
    - 实现收藏列表
    - 实现点击填充到输入框
    - 实现长按显示操作菜单（编辑、删除）
    - 实现搜索功能
    - _需求: 7.3, 7.4, 7.5, 7.6, 7.7_
  
  - [ ] 20.2 实现收藏编辑对话框
    - 实现名称和描述输入
    - 实现命令内容编辑
    - 实现标签管理
    - _需求: 7.2, 7.5_
  
  - [ ]* 20.3 编写命令收藏界面单元测试
    - 测试列表显示
    - 测试点击填充
    - 测试编辑功能
    - 测试删除功能
    - 测试搜索功能
    - _需求: 7.3, 7.4, 7.5, 7.6, 7.7_

- [ ] 21. 实现审计日志界面
  - [ ] 21.1 创建 AuditLogScreen 组件
    - 实现日志列表
    - 实现风险级别标识（颜色编码）
    - 实现点击查看详情
    - _需求: 11.3_
  
  - [ ] 21.2 实现日志筛选和导出
    - 实现设备筛选
    - 实现时间范围筛选
    - 实现风险级别筛选
    - 实现导出为 JSON/CSV
    - _需求: 11.4, 11.5_
  
  - [ ]* 21.3 编写审计日志界面单元测试
    - 测试列表显示
    - 测试筛选功能
    - 测试导出功能
    - _需求: 11.3, 11.4, 11.5_

- [ ] 22. 实现设置界面
  - [ ] 22.1 创建 SettingsScreen 组件
    - 实现 AI 服务提供商选择
    - 实现 API 密钥管理（输入、查看掩码、删除）
    - 实现隐私过滤开关
    - 实现危险命令警告开关
    - 实现语音输入开关
    - 实现语言选择
    - 实现主题选择
    - 实现离线模式切换
    - _需求: 10.1, 10.3, 10.5, 10.7, 3.6, 4.6, 13.1, 13.5, 9.7_
  
  - [ ] 22.2 实现设置持久化
    - 使用 MMKV 保存设置
    - 实现设置加载和保存
    - _需求: 13.6_
  
  - [ ]* 22.3 编写设置界面单元测试
    - 测试 API 密钥管理
    - 测试开关切换
    - 测试语言切换
    - 测试设置持久化
    - _需求: 10.1, 10.3, 10.7, 3.6, 13.1, 13.6_

- [ ] 23. 检查点 - UI 集成测试
  - 确保所有 UI 组件正常渲染
  - 验证导航流程
  - 验证用户交互
  - 如有问题请向用户报告


- [ ] 24. 实现导航和路由
  - [ ] 24.1 配置 React Navigation
    - 创建主导航器（Tab Navigator）
    - 添加 AI 助手、历史、收藏、审计、设置标签页
    - 配置导航样式和图标
    - _需求: 所有 UI 需求_
  
  - [ ] 24.2 实现深度链接
    - 支持从通知打开特定界面
    - 支持从外部链接打开
    - _需求: 所有 UI 需求_
  
  - [ ]* 24.3 编写导航单元测试
    - 测试导航跳转
    - 测试深度链接
    - _需求: 所有 UI 需求_

- [ ] 25. 集成现有 SSH 服务
  - [ ] 25.1 连接 NLController 和 SSHService
    - 使用第一阶段的 SSHService 执行命令
    - 处理 SSH 连接状态
    - 处理命令执行结果
    - _需求: 1.3, 1.7_
  
  - [ ] 25.2 实现设备上下文获取
    - 从 DeviceStore 获取当前设备信息
    - 获取当前目录信息
    - 获取 Shell 类型
    - _需求: 1.1_
  
  - [ ]* 25.3 编写 SSH 集成测试
    - 测试命令执行流程
    - 测试错误处理
    - _需求: 1.3, 1.7_

- [ ] 26. 实现端到端流程
  - [ ] 26.1 实现完整的自然语言命令流程
    - 用户输入 → 隐私过滤 → AI 解析 → 安全检查 → 用户确认 → SSH 执行 → 结果展示 → 历史记录 → 审计日志
    - 确保每个步骤正确衔接
    - 实现错误处理和回退
    - _需求: 1.1, 1.2, 1.3, 1.7, 3.1-3.4, 4.1-4.4, 6.1, 11.1_
  
  - [ ] 26.2 实现完整的语音输入流程
    - 按住录音 → 语音识别 → 文本显示 → 自然语言处理流程
    - 确保语音识别结果正确传递
    - 实现错误处理
    - _需求: 2.1, 2.2, 2.3, 2.4_
  
  - [ ]* 26.3 编写端到端集成测试
    - 测试完整的自然语言命令流程
    - 测试完整的语音输入流程
    - 测试错误场景
    - _需求: 所有核心需求_

- [ ] 27. 性能优化
  - [ ] 27.1 优化 AI 服务调用
    - 实现请求缓存
    - 实现请求去重
    - 优化 prompt 长度
    - _需求: 12.1_
  
  - [ ] 27.2 优化数据存储性能
    - 优化 MMKV 读写
    - 实现数据分页加载
    - 优化搜索算法
    - _需求: 12.4_
  
  - [ ] 27.3 优化 UI 性能
    - 实现列表虚拟化
    - 优化组件渲染
    - 减少不必要的重渲染
    - _需求: 12.7_
  
  - [ ]* 27.4 性能测试
    - 测试 AI 服务响应时间
    - 测试语音识别速度
    - 测试建议引擎响应时间
    - 测试历史查询性能
    - _需求: 12.1, 12.2, 12.3, 12.4_

- [ ] 28. 文档和示例
  - [ ] 28.1 编写 API 文档
    - 文档化所有公共接口
    - 添加使用示例
    - 添加类型定义说明
  
  - [ ] 28.2 编写用户指南
    - 创建快速开始指南
    - 创建功能使用说明
    - 创建常见问题解答
  
  - [ ] 28.3 创建示例和演示
    - 创建常用命令示例
    - 创建视频演示
    - 创建截图

- [ ] 29. 最终检查点 - 全面测试
  - 运行所有单元测试
  - 运行所有属性测试（每个至少100次迭代）
  - 运行所有集成测试
  - 验证代码覆盖率（目标 80%）
  - 验证所有需求都已实现
  - 在真实设备上测试
  - 修复发现的所有问题
  - 如有问题请向用户报告

## 注意事项

- 标记 `*` 的任务为可选任务，可以跳过以加快 MVP 开发
- 每个任务都引用了具体的需求编号，便于追溯
- 检查点任务确保增量验证
- 属性测试使用 fast-check 库，每个测试至少运行 100 次迭代
- 单元测试验证具体示例和边缘情况
- 属性测试和单元测试是互补的，都是必需的

## 测试标签格式

每个属性测试必须包含注释标签：
```typescript
// Feature: natural-language-control, Property N: [属性标题]
```

## 依赖关系

- 任务 1 必须首先完成（项目设置）
- 任务 2-6 可以并行开发（数据层）
- 任务 8-11 依赖任务 2-6（服务层）
- 任务 13-16 依赖任务 8-11（辅助功能）
- 任务 18-22 依赖所有服务层（UI 层）
- 任务 25-26 依赖所有前置任务（集成）
- 任务 27-29 在所有功能完成后进行（优化和完成）

